version: "3.1"

stories:

  - story: saudacao
    steps:
      - intent: greet
      - action: utter_greet

  - story: despedida
    steps:
      - intent: goodbye
      - action: utter_goodbye

  - story: caminho do agendamento vago
    steps:
      - intent: agendar_consulta
      - action: agendamento_consulta_form
      - active_loop: agendamento_consulta_form
      # Aqui o form fica ativo até completar os slots
      # Quando termina, ele desativa o form automaticamente.
      # A ação 'utter_submit_agendamento_consulta_form' será disparada pela REGRA 'Resumo após form'.
      # NÃO COLOQUE A AÇÃO AQUI NOVAMENTE.
      - intent: affirm # O usuário afirma o resumo
      - action: action_submit_agendamento
      - intent: goodbye
      - action: utter_goodbye

  - story: caminho do agendamento com sintomas
    steps:
      - intent: agendar_consulta
        entities:
          - sintoma_texto: "dor de cabeça" # Note: 'sintoma_texto' não é um slot ou entidade no seu domain.yml
      - action: agendamento_consulta_form
      - active_loop: agendamento_consulta_form
      - intent: inform_especialidade # Se o usuário informar a especialidade no meio do form
        entities:
          - especialidade: "clínico geral"
      # O form continua ativo até preencher todos os slots.
      # A ação 'utter_submit_agendamento_consulta_form' será disparada pela REGRA 'Resumo após form'.
      # NÃO COLOQUE A AÇÃO AQUI NOVAMENTE.
      - intent: affirm # O usuário afirma o resumo
      - action: action_submit_agendamento
      - intent: goodbye
      - action: utter_goodbye

  - story: finalizacao do agendamento negado
    steps:
      # Se esta história é para quando o formulário já foi submetido (e o resumo proferido),
      # então a primeira ação aqui deveria ser 'utter_submit_agendamento_consulta_form'
      # MAS ela não pode ser uma ação inicial se o bot não a fez.
      # Se a intenção é negar após o resumo, pode ser melhor reavaliar.
      # Por agora, para o conflito, a primeira linha está OK como está, pois ela simula
      # o bot tendo dito o resumo.
      - action: utter_submit_agendamento_consulta_form # Bot mostra o resumo
      - intent: deny # Usuário nega
      - action: utter_forms_deactivated # Bot desativa o formulário